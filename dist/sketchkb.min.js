/* 0.0.2Î²-MIT-Meziro(github.com/Meziro039/) */class SketchKb{constructor(Pages){this.Pages=Pages};Route(PageId,Root){PageId=Object.keys(this.Pages).includes(PageId)?PageId:"";Root=Root?Root:"";history.pushState(null,"",Root+PageId);try{exit()}catch(e){};this.Deploy(PageId)};async Deploy(PageId){const PageKeys=Object.keys(this.Pages[PageId]);const Bindable=this.Pages[PageId].Bind?!0:!1;if(Bindable){const UpLayerKey=PageId.slice(0,PageId.lastIndexOf("/")+1)+"*";if(Object.keys(this.Pages).includes(UpLayerKey)){await this.Deploy(UpLayerKey)}else{console.warn("Bind data not found.")}};for(let i=0;i<PageKeys.length;i++){if(PageKeys[i].match(/^#/)){let DrawingHtml=[];const ElementId=PageKeys[i].replace(/^#/,"");const Content=document.getElementById(ElementId)?!0:!1;if(Content){const ContentData=this.Pages[PageId]["#"+ElementId];const ContentKey=Object.keys(ContentData);if(ContentKey.includes("Html")){for(let j=0;j<ContentData.Html.length;j++){const CodePath=ContentData.Html[j];if(typeof CodePath==="string"){DrawingHtml.push(CodePath)}else{let CodeData="";const Cacheable=this.Pages[PageId].Cache?!0:!1;if(Cacheable){const CacheCheck=sessionStorage.getItem(CodePath)?!0:!1;if(CacheCheck){CodeData=sessionStorage.getItem(CodePath)}else{try{sessionStorage.setItem(CodePath,await(await fetch(CodePath)).text());CodeData=sessionStorage.getItem(CodePath)}catch(e){CodeData=await(await fetch(CodePath)).text()}}}else{CodeData=await(await fetch(CodePath)).text()};DrawingHtml.push(CodeData)}}};if(ContentKey.includes("Css")){for(let j=0;j<ContentData.Css.length;j++){const Path=ContentData.Css[j];let CodeData="";const Cacheable=this.Pages[PageId].Cache?!0:!1;if(Cacheable){const CacheCheck=sessionStorage.getItem(Path)?!0:!1;if(CacheCheck){CodeData=sessionStorage.getItem(Path)}else{try{sessionStorage.setItem(Path,await(await fetch(Path)).text());CodeData=sessionStorage.getItem(Path)}catch(e){CodeData=await(await fetch(Path)).text()}}}else{CodeData=await(await fetch(Path)).text()};DrawingHtml.push("<style>"+CodeData+"</style>")}};if(ContentKey.includes("Js")){for(let j=0;j<ContentData.Js.length;j++){const Path=ContentData.Js[j];let CodeData="";const Cacheable=this.Pages[PageId].Cache?!0:!1;if(Cacheable){const CacheCheck=sessionStorage.getItem(Path)?!0:!1;if(CacheCheck){CodeData=sessionStorage.getItem(Path)}else{try{sessionStorage.setItem(Path,await(await fetch(Path)).text());CodeData=sessionStorage.getItem(Path)}catch(e){CodeData=await(await fetch(Path)).text()}}}else{CodeData=await(await fetch(Path)).text()};DrawingHtml.push("<script>"+CodeData+"</script>")}};DrawingHtml=DrawingHtml.join("");let JsArray=[];const JsCheck=DrawingHtml.replace(/<!--.*?-->/gs,"").match(/<script.*?>.*?<\/script>/gs);if(JsCheck!=null&&JsCheck.length!==0){for(let j=0;j<JsCheck.length;j++){DrawingHtml=DrawingHtml.replaceAll(JsCheck[j],"");const NewEle=document.createElement("script");const ScriptSuevey=(new DOMParser()).parseFromString(JsCheck[j],"text/html").scripts[0];if(ScriptSuevey.src!=""){NewEle.src=ScriptSuevey.src};if(ScriptSuevey.type!=""){NewEle.type=ScriptSuevey.type};if(ScriptSuevey.crossOrigin!=null){NewEle.crossOrigin=ScriptSuevey.crossOrigin};if(ScriptSuevey.integrity!=""){NewEle.integrity=ScriptSuevey.integrity};if(ScriptSuevey.referrerPolicy!=""){NewEle.referrerPolicy=ScriptSuevey.referrerPolicy};if(ScriptSuevey.defer!=!1){NewEle.defer=ScriptSuevey.defer};if(ScriptSuevey.async!=!1){NewEle.async=ScriptSuevey.async};if(ScriptSuevey.textContent!=""){NewEle.textContent=ScriptSuevey.textContent};JsArray.push(NewEle)}};document.getElementById(ElementId).innerHTML=DrawingHtml;for(let j=0;j<JsArray.length;j++){document.getElementById(ElementId).appendChild(JsArray[j])};try{this.Pages[PageId].Run()}catch(e){}}}}}};console.log("%cSTOP!!\nIf you don't know how to use it, don't touch it.","font-size:20px");